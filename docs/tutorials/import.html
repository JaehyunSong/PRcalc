<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PRcalc - Import Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../figs/prcalc.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="PRcalc: R package for proportional representation allocation">
<meta property="og:description" content="Allocation! Measuring disproportionality! Decompsition! and Visualization!">
<meta property="og:image" content="figs/prcalc.png">
<meta property="og:site_name" content="PRcalc">
<meta name="twitter:title" content="PRcalc: R package for proportional representation allocation">
<meta name="twitter:description" content="Allocation! Measuring disproportionality! Decompsition! and Visualization!">
<meta name="twitter:image" content="figs/prcalc.png">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../figs/prcalc.png" alt="PRcalc logo" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PRcalc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../tutorials/calculation.html">
 <span class="dropdown-text">Seat allocation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/disproportionality.html">
 <span class="dropdown-text">Measuring disproportionality</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/decomposition.html">
 <span class="dropdown-text">Decomposition</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/import.html">
 <span class="dropdown-text">Import Dataset</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-supplement" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Supplement</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-supplement">    
        <li>
    <a class="dropdown-item" href="../supplement/list_of_methods.html">
 <span class="dropdown-text">List of methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../supplement/list_of_indices.html">
 <span class="dropdown-text">List of indices</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../supplement/dataset.html">
 <span class="dropdown-text">Sample Dataset</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../supplement/other_package.html">
 <span class="dropdown-text">Comparison with other packages</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-functions" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Functions</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-functions">    
        <li class="dropdown-header">Calculation</li>
        <li>
    <a class="dropdown-item" href="../man/prcalc.html">
 <span class="dropdown-text">prcalc()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/index.html">
 <span class="dropdown-text">index()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/decompose.html">
 <span class="dropdown-text">decompose()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/decompose2.html">
 <span class="dropdown-text">decompose2()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/decompose3.html">
 <span class="dropdown-text">decompose3()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/compare.html">
 <span class="dropdown-text">compare()</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Printing</li>
        <li>
    <a class="dropdown-item" href="../man/print.prcalc.html">
 <span class="dropdown-text">print.prcalc()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/summary.prcalc.html">
 <span class="dropdown-text">summary.prcalc()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/print.prcalc_compare.html">
 <span class="dropdown-text">print.prcalc_compare()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/print.prcalc_index.html">
 <span class="dropdown-text">print.prcalc_index()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/print.prcalc_index_compare.html">
 <span class="dropdown-text">print.prcalc_index_compare()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/print.prcalc_decomposition.html">
 <span class="dropdown-text">print.prcalc_decomposition()</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Plotting</li>
        <li>
    <a class="dropdown-item" href="../man/plot.prcalc.html">
 <span class="dropdown-text">plot.prcalc()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/plot.prcalc_compare.html">
 <span class="dropdown-text">plot.prcalc_compare()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/plot.prcalc_index.html">
 <span class="dropdown-text">plot.prcalc_index()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/plot.prcalc_index_compare.html">
 <span class="dropdown-text">plot.prcalc_index_compare()</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/plot.prcalc_decomposition_compare.html">
 <span class="dropdown-text">plot.prcalc_decomposition_compare()</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Utilities</li>
        <li>
    <a class="dropdown-item" href="../man/as_prcalc.html">
 <span class="dropdown-text">read_prcalc() / as_prcalc()</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JaehyunSong/PRcalc/"> <i class="bi bi-github" role="img" aria-label="PRcalc GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Import Dataset</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../NEWS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">News</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LICENSE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../CITATION.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Citation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session info.</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../memo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Memo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nested-and-spanned-structure" id="toc-nested-and-spanned-structure" class="nav-link active" data-scroll-target="#nested-and-spanned-structure">Nested and spanned structure</a></li>
  <li><a href="#example-1-spanned-structure" id="toc-example-1-spanned-structure" class="nav-link" data-scroll-target="#example-1-spanned-structure">Example 1: Spanned structure</a></li>
  <li><a href="#example-2-nested-structure" id="toc-example-2-nested-structure" class="nav-link" data-scroll-target="#example-2-nested-structure">Example 2: Nested structure</a></li>
  <li><a href="#example-3-using-.csv-file" id="toc-example-3-using-.csv-file" class="nav-link" data-scroll-target="#example-3-using-.csv-file">Example 3: Using <code>.csv</code> file</a></li>
  <li><a href="#example-4-single-level" id="toc-example-4-single-level" class="nav-link" data-scroll-target="#example-4-single-level">Example 4: Single level</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Import Dataset</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this section, we introduce how to convert tabular data that has already been allocated into <code>Prcalc</code> class objects.</p>
<section id="nested-and-spanned-structure" class="level2">
<h2 class="anchored" data-anchor-id="nested-and-spanned-structure">Nested and spanned structure</h2>
<p>{PRcalc} supports two types of data structures—“nested” and “span”. This represents the relationship between level 1 and level 2, where level 1 means state or region and level 2 means district or party. For example, if level 1 is state and level 2 is political party, the party would nominate candidates to multiple states. We describe this as “level 2 <strong>span</strong>s level 1”. On the other hand, if the constituency is within a state, we call it “level 2 <strong>nested</strong> in level 1”. The following figure shows the difference between “nested” and “span” structure. In {PRcalc}, default is <code>"nestd"</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">nested</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">span</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><img src="figs/import_nested.png" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><img src="figs/import_span.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="example-1-spanned-structure" class="level2">
<h2 class="anchored" data-anchor-id="example-1-spanned-structure">Example 1: Spanned structure</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PRcalc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load sample dataset, <code>jp_lower_2021_result</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"jp_lower_2021_result"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>jp_lower_2021_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 103 × 4
   Party Pref          Votes Seats
   &lt;chr&gt; &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt;
 1 Jimin Hokkaido     863300     3
 2 Jimin Tohoku      1628233     6
 3 Jimin Kitakanto   2172065     7
 4 Jimin Minamikanto 2590787     7
 5 Jimin Tokyo       2000084     5
 6 Jimin Hokuriku    1468380     5
 7 Jimin Tokai       2515841     8
 8 Jimin Kinki       2407699     8
 9 Jimin Chugoku     1352723     5
10 Jimin Shikoku      664805     2
# ℹ 93 more rows</code></pre>
</div>
</div>
<p>This dataset contains the number of votes and seats won by each party in each prefecture. For example, <em>Jimin</em> party received 863300 votes and won 3 seat in <em>Hokkaido</em>.</p>
<p>Level 1 (<code>l1</code>) here is <code>"Pref"</code> (prefectures) and level 2 (<code>l2</code>) is <code>"Party"</code> (parties). Also, <code>p</code> (before conversion) and <code>q</code> (after conversion) are the <code>"Votes"</code> (number of votes) and <code>"Seats"</code> (seats), respectively. Since the parties are across prefectures, the <code>type</code> is specified as <code>"span"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>obj1 <span class="ot">&lt;-</span> <span class="fu">as_prcalc</span>(jp_lower_2021_result,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">l1   =</span> <span class="st">"Pref"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">l2   =</span> <span class="st">"Party"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p    =</span> <span class="st">"Votes"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">q    =</span> <span class="st">"Seats"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"span"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>obj1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw:
     Level2 Hokkaido  Tohoku Kitakanto Minamikanto   Tokyo Hokuriku   Tokai
1     Jimin   863300 1628233   2172065     2590787 2000084  1468380 2515841
2     Komei   294371  456287    823930      850667  715450   322535  784976
3    Rikken   682913  991505   1391149     1651562 1293281   773076 1485947
4    Kyosan   207189  292830    444115      534493  670340   225551  408606
5     Ishin   215344  258690    617531      863897  858577   361476  694630
6   Kokumin    73621  195754    298056      384482  306180   133600  382734
7    Shamin    41248  101442     97963      124447   92995    71185   84220
8     Reiwa   102086  143265    239592      302675  360387   111281  273208
9       NHK    42916   52664     87702      111298   92353    43529   98238
10 Sijinasi    46142       0         0           0       0        0       0
11  Daiichi        0       0         0           0   33661        0       0
12   Yamato        0       0         0           0   16970        0       0
13   Corona        0       0         0           0    6620        0       0
     Kinki Chugoku Shikoku  Kyushu    Total
1  2407699 1352723  664805 2250966 19914883
2  1155683  436220  233407 1040756  7114282
3  1090666  573324  291871 1266801 11492095
4   736156  173117  108021  365658  4166076
5  3180219  286302  173826  540338  8050830
6   303480  113899  122082  279509  2593397
7   100980   52638   30249  221221  1018588
8   292483   94446   52941  243284  2215648
9   111539   36758   21285   98506   796788
10       0       0       0       0    46142
11       0       0       0       0    33661
12       0       0       0       0    16970
13       0       0       0       0     6620

Result:
     Level2 Hokkaido Tohoku Kitakanto Minamikanto Tokyo Hokuriku Tokai Kinki
1     Jimin        3      6         7           7     5        5     8     8
2     Komei        1      2         3           2     2        1     3     4
3    Rikken        2      3         5           5     4        3     5     4
4    Kyosan        1      1         1           2     2        1     1     2
5     Ishin        1      1         2           3     2        1     2    10
6   Kokumin        0      1         1           1     1        0     1     1
7    Shamin        0      0         0           0     0        0     0     0
8     Reiwa        0      0         1           1     1        0     1     1
9       NHK        0      0         0           0     0        0     0     0
10 Sijinasi        0      0         0           0     0        0     0     0
11  Daiichi        0      0         0           0     0        0     0     0
12   Yamato        0      0         0           0     0        0     0     0
13   Corona        0      0         0           0     0        0     0     0
   Chugoku Shikoku Kyushu Total
1        5       2      8    64
2        2       1      3    24
3        2       1      4    38
4        1       0      1    13
5        1       1      2    26
6        0       1      1     8
7        0       0      1     1
8        0       0      1     6
9        0       0      0     0
10       0       0      0     0
11       0       0      0     0
12       0       0      0     0
13       0       0      0     0

Parameters:
  Allocation method: 
  Extra parameter: 
  Threshold: 

Magnitude: 
   Hokkaido      Tohoku   Kitakanto Minamikanto       Tokyo    Hokuriku 
          8          14          20          21          17          11 
      Tokai       Kinki     Chugoku     Shikoku      Kyushu 
         21          30          11           6          21 </code></pre>
</div>
</div>
<p>If you have a dataset that has already been calculated, a <code>PRcalc</code> class object can be created instead of using <code>prcalc()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(obj1, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">subset_p  =</span> <span class="fu">c</span>(<span class="st">"Jimin"</span>, <span class="st">"Komei"</span>, <span class="st">"Rikken"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Kyosan"</span>, <span class="st">"Ishin"</span>, <span class="st">"Kokumin"</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">facet_col =</span> <span class="dv">3</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">angle     =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="import_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-2-nested-structure" class="level2">
<h2 class="anchored" data-anchor-id="example-2-nested-structure">Example 2: Nested structure</h2>
<p>A sample dataset <code>au_district_2010</code> contains information on the number of electoral district constants. In this case, each constituency (<code>"district"</code>) is nested in a region (<code>"region"</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"au_district_2010"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>au_district_2010</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          region        district electorates magnitude
1   Australian Capital Territory        CANBERRA      124294         1
2   Australian Capital Territory          FRASER      123647         1
3                New South Wales           BANKS       98742         1
4                New South Wales          BARTON       95231         1
5                New South Wales       BENNELONG       98915         1
6                New South Wales         BEROWRA       95124         1
7                New South Wales        BLAXLAND       95362         1
8                New South Wales       BRADFIELD       97255         1
9                New South Wales          CALARE       98463         1
10               New South Wales        CHARLTON       94474         1
11               New South Wales         CHIFLEY       97605         1
12               New South Wales            COOK      100733         1
13               New South Wales          COWPER       94654         1
14               New South Wales      CUNNINGHAM      100643         1
15               New South Wales          DOBELL       93646         1
16               New South Wales     EDEN-MONARO       96465         1
17               New South Wales          FARRER       94026         1
18               New South Wales          FOWLER       95564         1
19               New South Wales         GILMORE       96340         1
20               New South Wales       GRAYNDLER       98112         1
21               New South Wales        GREENWAY       93837         1
22               New South Wales          HUGHES       97998         1
23               New South Wales            HUME       97719         1
24               New South Wales          HUNTER       91523         1
25               New South Wales KINGSFORD SMITH       97730         1
26               New South Wales         LINDSAY       95975         1
27               New South Wales            LYNE       92535         1
28               New South Wales       MACARTHUR       90040         1
29               New South Wales       MACKELLAR       98520         1
30               New South Wales       MACQUARIE       97536         1
31               New South Wales         MCMAHON       96061         1
32               New South Wales        MITCHELL       93573         1
33               New South Wales     NEW ENGLAND       99616         1
34               New South Wales       NEWCASTLE       92855         1
35               New South Wales    NORTH SYDNEY       97578         1
36               New South Wales            PAGE       94336         1
37               New South Wales          PARKES      100170         1
38               New South Wales      PARRAMATTA       93999         1
39               New South Wales        PATERSON       92140         1
40               New South Wales            REID       95878         1
41               New South Wales        RICHMOND       92391         1
42               New South Wales        RIVERINA       98584         1
43               New South Wales       ROBERTSON       96588         1
44               New South Wales       SHORTLAND       94224         1
45               New South Wales          SYDNEY       95286         1
46               New South Wales         THROSBY       95871         1
47               New South Wales       WARRINGAH       96708         1
48               New South Wales          WATSON       97761         1
49               New South Wales       WENTWORTH      101446         1
50               New South Wales         WERRIWA       90963         1
51            Northern Territory        LINGIARI       61168         1
52            Northern Territory         SOLOMON       59891         1
53                    Queensland           BLAIR       83045         1
54                    Queensland          BONNER       92661         1
55                    Queensland          BOWMAN       91856         1
56                    Queensland        BRISBANE       92197         1
57                    Queensland     CAPRICORNIA       91961         1
58                    Queensland          DAWSON       94533         1
59                    Queensland         DICKSON       90130         1
60                    Queensland          FADDEN       85225         1
61                    Queensland         FAIRFAX       89726         1
62                    Queensland          FISHER       83724         1
63                    Queensland           FLYNN       91349         1
64                    Queensland           FORDE       82535         1
65                    Queensland        GRIFFITH       92573         1
66                    Queensland           GROOM       93364         1
67                    Queensland         HERBERT       91044         1
68                    Queensland         HINKLER       91371         1
69                    Queensland         KENNEDY       94434         1
70                    Queensland      LEICHHARDT       93113         1
71                    Queensland          LILLEY       97407         1
72                    Queensland         LONGMAN       87046         1
73                    Queensland         MARANOA       97892         1
74                    Queensland       MCPHERSON       90139         1
75                    Queensland       MONCRIEFF       89150         1
76                    Queensland         MORETON       92730         1
77                    Queensland           OXLEY       82768         1
78                    Queensland          PETRIE       86651         1
79                    Queensland          RANKIN       94594         1
80                    Queensland            RYAN       98239         1
81                    Queensland        WIDE BAY       92607         1
82                    Queensland          WRIGHT       85296         1
83               South Australia        ADELAIDE       98519         1
84               South Australia          BARKER      104845         1
85               South Australia         BOOTHBY       97860         1
86               South Australia            GREY       99775         1
87               South Australia       HINDMARSH      100216         1
88               South Australia        KINGSTON      102281         1
89               South Australia           MAKIN       96233         1
90               South Australia            MAYO      101510         1
91               South Australia   PORT ADELAIDE      104280         1
92               South Australia           STURT       99023         1
93               South Australia       WAKEFIELD      100156         1
94                      Tasmania            BASS       71686         1
95                      Tasmania         BRADDON       71576         1
96                      Tasmania         DENISON       71350         1
97                      Tasmania        FRANKLIN       71122         1
98                      Tasmania           LYONS       72875         1
99                      Victoria           ASTON       93447         1
100                     Victoria        BALLARAT       97756         1
101                     Victoria          BATMAN       89131         1
102                     Victoria         BENDIGO      100610         1
103                     Victoria           BRUCE       88124         1
104                     Victoria         CALWELL      101342         1
105                     Victoria           CASEY       92317         1
106                     Victoria        CHISHOLM       86220         1
107                     Victoria     CORANGAMITE      101512         1
108                     Victoria           CORIO       91924         1
109                     Victoria          DEAKIN       87710         1
110                     Victoria         DUNKLEY       95299         1
111                     Victoria        FLINDERS      100852         1
112                     Victoria      GELLIBRAND       95571         1
113                     Victoria       GIPPSLAND       97521         1
114                     Victoria       GOLDSTEIN       93918         1
115                     Victoria          GORTON      113675         1
116                     Victoria         HIGGINS       90409         1
117                     Victoria            HOLT      108891         1
118                     Victoria          HOTHAM       89529         1
119                     Victoria            INDI       92914         1
120                     Victoria          ISAACS      102769         1
121                     Victoria        JAGAJAGA       95146         1
122                     Victoria         KOOYONG       89626         1
123                     Victoria        LA TROBE       97956         1
124                     Victoria           LALOR      116976         1
125                     Victoria          MALLEE       89824         1
126                     Victoria     MARIBYRNONG       88413         1
127                     Victoria          MCEWEN      115811         1
128                     Victoria        MCMILLAN       93285         1
129                     Victoria       MELBOURNE      102881         1
130                     Victoria MELBOURNE PORTS       97766         1
131                     Victoria         MENZIES       90931         1
132                     Victoria          MURRAY       90182         1
133                     Victoria         SCULLIN       90811         1
134                     Victoria          WANNON       92236         1
135                     Victoria           WILLS       98588         1
136            Western Australia           BRAND       88186         1
137            Western Australia         CANNING       90079         1
138            Western Australia           COWAN       89536         1
139            Western Australia          CURTIN       90430         1
140            Western Australia          DURACK       85811         1
141            Western Australia         FORREST       89649         1
142            Western Australia       FREMANTLE       93378         1
143            Western Australia         HASLUCK       93930         1
144            Western Australia           MOORE       92340         1
145            Western Australia        O'CONNOR       92902         1
146            Western Australia          PEARCE       89562         1
147            Western Australia           PERTH       91907         1
148            Western Australia        STIRLING       91775         1
149            Western Australia            SWAN       90817         1
150            Western Australia         TANGNEY       92232         1</code></pre>
</div>
</div>
<p>The number before conversion (<code>p</code>) is the number of electorates (<code>"electorates"</code>); the number after conversion (<code>q</code>) is the number of seats (<code>"magnitude"</code>). However, if all <code>q</code> are 1, as in this example, the <code>q</code> argument can be omitted.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>obj2 <span class="ot">&lt;-</span> <span class="fu">as_prcalc</span>(au_district_2010,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">l1   =</span> <span class="st">"region"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">l2   =</span> <span class="st">"district"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p    =</span> <span class="st">"electorates"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">q    =</span> <span class="st">"magnitude"</span>,   <span class="co"># omittable</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"nested"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>obj2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw:
   Level2 Australian Capital Territory New South Wales Northern Territory
1       1                       124294           98742              61168
2       2                       123647           95231              59891
3       3                            0           98915                  0
4       4                            0           95124                  0
5       5                            0           95362                  0
6       6                            0           97255                  0
7       7                            0           98463                  0
8       8                            0           94474                  0
9       9                            0           97605                  0
10     10                            0          100733                  0
11     11                            0           94654                  0
12     12                            0          100643                  0
13     13                            0           93646                  0
14     14                            0           96465                  0
15     15                            0           94026                  0
16     16                            0           95564                  0
17     17                            0           96340                  0
18     18                            0           98112                  0
19     19                            0           93837                  0
20     20                            0           97998                  0
21     21                            0           97719                  0
22     22                            0           91523                  0
23     23                            0           97730                  0
24     24                            0           95975                  0
25     25                            0           92535                  0
26     26                            0           90040                  0
27     27                            0           98520                  0
28     28                            0           97536                  0
29     29                            0           96061                  0
30     30                            0           93573                  0
31     31                            0           99616                  0
32     32                            0           92855                  0
33     33                            0           97578                  0
34     34                            0           94336                  0
35     35                            0          100170                  0
36     36                            0           93999                  0
37     37                            0           92140                  0
38     38                            0           95878                  0
39     39                            0           92391                  0
40     40                            0           98584                  0
41     41                            0           96588                  0
42     42                            0           94224                  0
43     43                            0           95286                  0
44     44                            0           95871                  0
45     45                            0           96708                  0
46     46                            0           97761                  0
47     47                            0          101446                  0
48     48                            0           90963                  0
   Queensland South Australia Tasmania Victoria Western Australia  Total
1       83045           98519    71686    93447             88186 719087
2       92661          104845    71576    97756             90079 735686
3       91856           97860    71350    89131             89536 538648
4       92197           99775    71122   100610             90430 549258
5       91961          100216    72875    88124             85811 534349
6       94533          102281        0   101342             89649 485060
7       90130           96233        0    92317             93378 470521
8       85225          101510        0    86220             93930 461359
9       89726          104280        0   101512             92340 485463
10      83724           99023        0    91924             92902 468306
11      91349          100156        0    87710             89562 463431
12      82535               0        0    95299             91907 370384
13      92573               0        0   100852             91775 378846
14      93364               0        0    95571             90817 376217
15      91044               0        0    97521             92232 374823
16      91371               0        0    93918                 0 280853
17      94434               0        0   113675                 0 304449
18      93113               0        0    90409                 0 281634
19      97407               0        0   108891                 0 300135
20      87046               0        0    89529                 0 274573
21      97892               0        0    92914                 0 288525
22      90139               0        0   102769                 0 284431
23      89150               0        0    95146                 0 282026
24      92730               0        0    89626                 0 278331
25      82768               0        0    97956                 0 273259
26      86651               0        0   116976                 0 293667
27      94594               0        0    89824                 0 282938
28      98239               0        0    88413                 0 284188
29      92607               0        0   115811                 0 304479
30      85296               0        0    93285                 0 272154
31          0               0        0   102881                 0 202497
32          0               0        0    97766                 0 190621
33          0               0        0    90931                 0 188509
34          0               0        0    90182                 0 184518
35          0               0        0    90811                 0 190981
36          0               0        0    92236                 0 186235
37          0               0        0    98588                 0 190728
38          0               0        0        0                 0  95878
39          0               0        0        0                 0  92391
40          0               0        0        0                 0  98584
41          0               0        0        0                 0  96588
42          0               0        0        0                 0  94224
43          0               0        0        0                 0  95286
44          0               0        0        0                 0  95871
45          0               0        0        0                 0  96708
46          0               0        0        0                 0  97761
47          0               0        0        0                 0 101446
48          0               0        0        0                 0  90963

Result:
   Level2 Australian Capital Territory New South Wales Northern Territory
1       1                            1               1                  1
2       2                            1               1                  1
3       3                            0               1                  0
4       4                            0               1                  0
5       5                            0               1                  0
6       6                            0               1                  0
7       7                            0               1                  0
8       8                            0               1                  0
9       9                            0               1                  0
10     10                            0               1                  0
11     11                            0               1                  0
12     12                            0               1                  0
13     13                            0               1                  0
14     14                            0               1                  0
15     15                            0               1                  0
16     16                            0               1                  0
17     17                            0               1                  0
18     18                            0               1                  0
19     19                            0               1                  0
20     20                            0               1                  0
21     21                            0               1                  0
22     22                            0               1                  0
23     23                            0               1                  0
24     24                            0               1                  0
25     25                            0               1                  0
26     26                            0               1                  0
27     27                            0               1                  0
28     28                            0               1                  0
29     29                            0               1                  0
30     30                            0               1                  0
31     31                            0               1                  0
32     32                            0               1                  0
33     33                            0               1                  0
34     34                            0               1                  0
35     35                            0               1                  0
36     36                            0               1                  0
37     37                            0               1                  0
38     38                            0               1                  0
39     39                            0               1                  0
40     40                            0               1                  0
41     41                            0               1                  0
42     42                            0               1                  0
43     43                            0               1                  0
44     44                            0               1                  0
45     45                            0               1                  0
46     46                            0               1                  0
47     47                            0               1                  0
48     48                            0               1                  0
   Queensland South Australia Tasmania Victoria Western Australia Total
1           1               1        1        1                 1     8
2           1               1        1        1                 1     8
3           1               1        1        1                 1     6
4           1               1        1        1                 1     6
5           1               1        1        1                 1     6
6           1               1        0        1                 1     5
7           1               1        0        1                 1     5
8           1               1        0        1                 1     5
9           1               1        0        1                 1     5
10          1               1        0        1                 1     5
11          1               1        0        1                 1     5
12          1               0        0        1                 1     4
13          1               0        0        1                 1     4
14          1               0        0        1                 1     4
15          1               0        0        1                 1     4
16          1               0        0        1                 0     3
17          1               0        0        1                 0     3
18          1               0        0        1                 0     3
19          1               0        0        1                 0     3
20          1               0        0        1                 0     3
21          1               0        0        1                 0     3
22          1               0        0        1                 0     3
23          1               0        0        1                 0     3
24          1               0        0        1                 0     3
25          1               0        0        1                 0     3
26          1               0        0        1                 0     3
27          1               0        0        1                 0     3
28          1               0        0        1                 0     3
29          1               0        0        1                 0     3
30          1               0        0        1                 0     3
31          0               0        0        1                 0     2
32          0               0        0        1                 0     2
33          0               0        0        1                 0     2
34          0               0        0        1                 0     2
35          0               0        0        1                 0     2
36          0               0        0        1                 0     2
37          0               0        0        1                 0     2
38          0               0        0        0                 0     1
39          0               0        0        0                 0     1
40          0               0        0        0                 0     1
41          0               0        0        0                 0     1
42          0               0        0        0                 0     1
43          0               0        0        0                 0     1
44          0               0        0        0                 0     1
45          0               0        0        0                 0     1
46          0               0        0        0                 0     1
47          0               0        0        0                 0     1
48          0               0        0        0                 0     1

Parameters:
  Allocation method: 
  Extra parameter: 
  Threshold: 

Magnitude: 
Australian Capital Territory              New South Wales 
                           2                           48 
          Northern Territory                   Queensland 
                           2                           30 
             South Australia                     Tasmania 
                          11                            5 
                    Victoria            Western Australia 
                          37                           15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decompose</span>(obj2, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">as_disprop =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>alpha = 0 
alpha-divergence  Reapportionment    Redistricting 
     0.004280586      0.003107794      0.001172792 

Note: "alha-divergence" is sum of "Reapportionment" and "Redisticting" terms.</code></pre>
</div>
</div>
</section>
<section id="example-3-using-.csv-file" class="level2">
<h2 class="anchored" data-anchor-id="example-3-using-.csv-file">Example 3: Using <code>.csv</code> file</h2>
<p>With <code>read_prcalc()</code>, you can create a <code>PRcalc</code> class object directly from a <code>.csv</code> file. Sample dataset can be downloaded from <a href="../data/sample_dataset.csv">here</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Because default value of `type` is `"district"`, you can omit it.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>obj3 <span class="ot">&lt;-</span> <span class="fu">read_prcalc</span>(<span class="st">"../data/sample_dataset.csv"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">l1 =</span> <span class="st">"region"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">l2 =</span> <span class="st">"district"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p  =</span> <span class="st">"electorates"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">q  =</span> <span class="st">"magnitude"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">index</span>(obj3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            ID                         Index    Value
1       dhondt                       D’Hondt 1.054507
2       monroe                        Monroe 0.005322
3       maxdev    Maximum Absolute Deviation 0.002287
4     mm_ratio                 Max-Min ratio 1.139626
5          rae                           Rae 0.000523
6           lh             Loosemore &amp; Hanby 0.012541
7      grofman                       Grofman 0.000685
8     lijphart                      Lijphart 0.001698
9    gallagher                     Gallagher 0.003814
10 g_gallagher         Generalized Gallagher 0.003814
11       gatev                         Gatev 0.022992
12    ryabtsev                      Ryabtsev 0.016260
13      szalai                        Szalai 0.016607
14    w_szalai               Weighted Szalai 0.016319
15          ap          Aleskerov &amp; Platonov 1.021303
16        gini                          Gini 0.018644
17    atkinson                      Atkinson 0.001076
18          sl                  Sainte-Laguë 0.001055
19          cs                 Cox &amp; Shugart 1.030364
20      farina                        Farina 0.035109
21      ortona                        Ortona 0.008979
22          cd          Cosine Dissimilarity 0.000499
23          rr Lebeda’s RR (Mixture D’Hondt) 0.051690
24         arr                  Lebeda’s ARR 0.001077
25         srr                  Lebeda’s SRR 0.008936
26        wdrr                 Lebeda’s WDRR 0.025591
27          kl     Kullback-Leibler Surprise 0.000531
28          lr    Likelihood Ratio Statistic 0.001069
29       chisq                   Chi Squared 0.001077
30   hellinger            Hellinger Distance 0.011541
31          ad              alpha-Divergence 0.000527</code></pre>
</div>
</div>
</section>
<section id="example-4-single-level" class="level2">
<h2 class="anchored" data-anchor-id="example-4-single-level">Example 4: Single level</h2>
<p>A sample dataset, <code>br_district_2010</code> is the Brazilian electoral districts in 2010.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"br_district_2010"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>br_district_2010</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              district magnitude population
1            Sao Paulo        70   39924091
2         Minas Gerais        53   19159260
3       Rio de Janeiro        46   15180636
4                Bahia        39   13633969
5    Rio Grande do Sul        31   10576758
6               Parana        30   10226737
7           Pernambuco        25    8541250
8                Ceara        22    8450527
9             Maranhao        18    6424340
10               Goias        17    5849105
11                Para        17    7443904
12      Santa Catarina        16    6178603
13             Paraiba        12    3753633
14      Espirito Santo        10    3392775
15               Piaui        10    3086448
16             Alagoas         9    3093994
17               Acre          8     707125
18            Amazonas         8    3350773
19               Amapa         8     648553
20    Distrito Federal         8    2469489
21  Mato Grosso do Sul         8    2404256
22         Mato Grosso         8    2954625
23 Rio Grande do Norte         8    3121451
24            Rondonia         8    1535625
25             Roraima         8     425398
26             Sergipe         8    2036227
27           Tocantins         8    1373551</code></pre>
</div>
</div>
<p>This dataset is a one-dimensional structure, whereas previous examples were two-dimensional structures, such as constituency and party, or region and constituency. In such a one-dimensional structure, <code>l2</code> can be omitted.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>obj4 <span class="ot">&lt;-</span> br_district_2010 <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_prcalc</span>(<span class="at">l1   =</span> <span class="st">"district"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">p    =</span> <span class="st">"population"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">q    =</span> <span class="st">"magnitude"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">"span"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>obj4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw:
                Level2 National
1            Sao Paulo 39924091
2         Minas Gerais 19159260
3       Rio de Janeiro 15180636
4                Bahia 13633969
5    Rio Grande do Sul 10576758
6               Parana 10226737
7           Pernambuco  8541250
8                Ceara  8450527
9             Maranhao  6424340
10               Goias  5849105
11                Para  7443904
12      Santa Catarina  6178603
13             Paraiba  3753633
14      Espirito Santo  3392775
15               Piaui  3086448
16             Alagoas  3093994
17               Acre    707125
18            Amazonas  3350773
19               Amapa   648553
20    Distrito Federal  2469489
21  Mato Grosso do Sul  2404256
22         Mato Grosso  2954625
23 Rio Grande do Norte  3121451
24            Rondonia  1535625
25             Roraima   425398
26             Sergipe  2036227
27           Tocantins  1373551

Result:
                Level2 National
1            Sao Paulo       70
2         Minas Gerais       53
3       Rio de Janeiro       46
4                Bahia       39
5    Rio Grande do Sul       31
6               Parana       30
7           Pernambuco       25
8                Ceara       22
9             Maranhao       18
10               Goias       17
11                Para       17
12      Santa Catarina       16
13             Paraiba       12
14      Espirito Santo       10
15               Piaui       10
16             Alagoas        9
17               Acre         8
18            Amazonas        8
19               Amapa        8
20    Distrito Federal        8
21  Mato Grosso do Sul        8
22         Mato Grosso        8
23 Rio Grande do Norte        8
24            Rondonia        8
25             Roraima        8
26             Sergipe        8
27           Tocantins        8

Parameters:
  Allocation method: 
  Extra parameter: 
  Threshold: 

Magnitude: 513</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>